\documentclass[12pt, a4paper]{article}
\usepackage{amsmath}
\usepackage{hyperref}

\hypersetup{colorlinks=true, linkcolor=black}

\title{Control Systems Practical 1}
\date{21 August 2018}
\author{Q. Kruger, 216008466 \and R. de Bruyn, 216969696}

\begin{document}
	\pagenumbering{gobble}
	\maketitle
	\newpage
	\pagenumbering{roman}
	\tableofcontents
	\newpage
	\pagenumbering{arabic}
	
	\section{Introduction} % (fold)
	\label{sec:introduction}
		This is an introductory practical to control systems computing using MATLAB/Octave. The purpose of this practical is to become familiar with the common functions used to analyze control systems.
	% section introduction (end)

	\section{Equipment and Tools} % (fold)
	\label{sec:equipment_and_tools}
		The only equipment used during this practical is the MATLAB/Octave scientific computing platforms.
	% section equipment_and_tools (end)

	\section{Prelab} % (fold)
	\label{sec:prelab}
		\subsection*{Question 1} % (fold)
		\label{sub:question_1}
			\begin{itemize}
				\item[a)] $s_{roots} = \{-2,-3,-4\}$
				\item[b)] $s_{roots} = \{0,-1,-5,-6\}$
				\item[c)] $P_3 = s^4 + 13s^3 + 50s^2 + 56s + 24$\\
						  $P_4 = -s^4 -11s^3 -32s^2 -4s + 24$ \\
						  $P_5 = s^7 + 21s^6 + 175s^5 +735s^4 + 1624s^3 + 1764s^2 + 720s$
			\end{itemize}
		% subsection question_1 (end)

		\subsection*{Question 2} % (fold)
		\label{sub:question_2}
			\begin{equation*}
				\begin{array}{rcl}
					P_6 & = & (s+7)(s+8)(s+3)(s+5)(s+9)(s+10) \\
					& = & s^6 + 42s^5 +718s^4 + 6\,732s^3 + 30\,820s^2 + 76\,530s + 7\,560
				\end{array}
			\end{equation*}
		% subsection question_2 (end)

		\subsection*{Question 3a}
		\label{sub:question_3a}
			\begin{equation*}
				\begin{array}{rcl}
					G_1(s) & = & \frac{20(s+2)(s+3)(s+6)(s+8)}{s(s+7)(s+9)(s+10)(s+15)}\\
					& = & \frac{20(s^3+5s^2+6s+6s^2+30s+36)(s+8)}{(s^3+7s^2+9s^2+63s)(s+10)(s+15)}\\
					& = & \frac{20(s^3+41s^2+36s+36)(s+8)}{(s^3+16s^2+63s)(s+10)(s+15)}\\
					& = & \frac{20s^4+380s^3+2480s^2+6480s+5760}{s^5+26s^4+223s^3+630s^2+15s^4+390s^3+3345s^2+9450s}\\
					& = & \frac{20s^4+380s^3+2480s^2+6480s+5760}{s^5+41s^4+613s^3+3975s^2+9450s}
				\end{array}
			\end{equation*} 

		\subsection*{Question 3b}
		\label{sub:question_3b}
			Now using the Rationale Root Theorem to find the factors of the numerator and denominator, we find that $(s+2)$ is a factor of the numerator
			\begin{equation*}
				\begin{array}{rcl}
				(s+2)(s^2+7s+12) & = & (s+2)(s+3)(s+4) \\
				\end{array}
			\end{equation*}
			The denominator can be given as
			\begin{equation*}
				\begin{array}{rcl}
				(s^4+12s^3++41s^2+30s) & = & (s)(s^3+12s^2+41s+30) \\
				\end{array}
			\end{equation*}
			Applying the same theorem as before, the second term in the equation* has a common factor given as $(s+1)$. The denominator is then given as 
			\begin{equation*}
					s(s+1)(s+6)(s+5)
			\end{equation*}
			Thus the final equation is given as 
			\begin{equation*}
				\begin{array}{rcl}
				G_2(s) & = & \frac{(s+2)(s+3)(s+7)}{s(s+1)(s+6)(s+5)}
				\end{array}
			\end{equation*}


		\subsection*{Question 3c}
		\label{sub:question_3c}
		\begin{equation*}
			\begin{array}{rcl}
				G_3(s) & = & G_1(s)+G_2(s)\\
				& = & \frac{20(s+2)(s+3)(s+6)(s+8)}{s(s+7)(s+9)(s+10)(s+15)} + \frac{(s+2)(s+3)(s+4)}{s(s+1)(s+6)(s+5)}\\
				& = & \frac{20(s+2)(s+3)(s+6)(s+8)(s+1)(s+5)+(s+2)(s+3)(s+4)(s+7)(s+9)(s+10)(s+15)}{s(s+7)(s+9)(s+10)(s+15)(s+1)(s+6)(s+5)}\\
			\end{array}
		\end{equation*}
		\begin{equation*}
			\begin{array}{rcl}
				G_3(s) & = & G_1(s)-G_2(s)\\
				& = & \frac{20(s+2)(s+3)(s+6)(s+8)}{s(s+7)(s+9)(s+10)(s+15)} - \frac{(s+2)(s+3)(s+4)}{s(s+1)(s+6)(s+5)}\\
				& = & \frac{20(s+2)(s+3)(s+6)(s+8)(s+1)(s+5)-(s+2)(s+3)(s+4)(s+7)(s+9)(s+10)(s+15)}{s(s+7)(s+9)(s+10)(s+15)(s+1)(s+6)(s+5)}\\
			\end{array}
		\end{equation*}
		\begin{equation*}
			\begin{array}{rcl}
				G_5(s) & = & G_1(s)G_2(s)\\
				& = & \frac{20(s+2)(s+3)(s+6)(s+8)}{s(s+7)(s+9)(s+10)(s+15)}{} \times \frac{(s+2)(s+3)(s+7)}{s(s+1)(s+6)(s+5)}\\
				& = & \frac{20(s+2)^2(s+3)^3(s+8)}{s^2(s+1)(s+5)(s+9)(s+10)(s+15)}
			\end{array}
		\end{equation*}

	\subsection*{Question 4a}
		\label{sub:question_4a}
		\begin{equation*}
			\begin{array}{rcl}
				G_6(s) & = & \frac{5(s+2)}{s(s^2+8s+15)}\\
				& = & \frac{5(s+2)}{s(s+5)(s+3)}\\
				& = & \frac{K_1}{s} + \frac{K_2}{s+5} + \frac{K_1}{s+3}
			\end{array}
		\end{equation*}

		\begin{equation*}
			\begin{array}{rcl}
				K_1 & = & \frac{5(s+2)}{(s+5)(s+3)} \bigg\rvert_{s=0} = \frac{2}{3}\\
				\\
				K_2 & = & \frac{5(s+2)}{s(s+3)} \bigg\rvert_{s=-5} = \frac{-3}{2} \\
				\\
				K_3 & = & \frac{5(s+2)}{(s+5)} \bigg\rvert_{s=-3} = \frac{5}{6} \\
				\\
				\\
				G_6(s) & = & \frac{\frac{2}{3}}{s} - \frac{\frac{2}{3}}{s+5} + \frac{\frac{5}{6}}{s+3}\\
			\end{array}
		\end{equation*}

	\subsection*{Question 4b}
		\label{sub:question_4b}
		\[
			\begin{array}{rcl}
				G_7(s) & = & \frac{5(s+2)}{s(s^2 + 6s + 9)}\\
				& = & \frac{5s+10}{s(s+3)^2}
			\end{array}
		\]
		\noindent Expanding $G_7(s)$ into partial fractions, we get the equation
		\[
			\frac{5s+10}{s(s+3)^2} = \frac{A}{s} + \frac{B}{(s+3)} + \frac{C}{(s+3)^2}
		\]

		We can then get the coefficients by using Heaviside's method:
		\[
			\begin{array}{rcl}
				A & = & \frac{5s + 10}{(s+3)^2}\bigg\rvert_{s=0}\\
				& = & \frac{10}{9}
			\end{array}
		\]
		\[
			\begin{array}{rcl}
				B & = & \frac{d}{ds}\left(\frac{5s + 10}{s}\right)\bigg\rvert_{s=-3}\\
				& = & \frac{5s - 5s - 10}{s^2}\bigg\rvert_{s=-3}\\
				& = & -\frac{10}{9}
			\end{array}
		\]
		\[
			\begin{array}{rcl}
				C & = & \frac{5s + 10}{s}\bigg\rvert_{s=-3} \\
				& = & \frac{5}{3}
			\end{array}
		\]

		\noindent Therefore we have
		\[
			G_7(s) = \frac{10}{9} \cdot \frac{1}{s} - \frac{10}{9} \cdot \frac{1}{s+3} + \frac{5}{3} \cdot \frac{1}{(s+3)^2}
		\]
	\subsection*{Question 4c}
	\label{sub:question_4c}
		\begin{equation*}
			\begin{array}{rcl}
				G_8 (s) & = & \frac{s(s+2)}{s(s^2+6s+34)} \\
				& = & \frac{K_1}{s}+\frac{K_2s + K_3}{s^2+6s+34}\\ 
			\end{array}
		\end{equation*}

		\begin{equation*}
			\begin{array}{rcl}
				K_1  & = & \frac{5(s+2)}{(s^2+6s+34)}\bigg\rvert_{s=0} = \frac{10}{34}
				\\ 
			\end{array}
		\end{equation*}
		Now in finding the other constants we substitute in the value obtained for $K_1$ and balance $LHS$ and $RHS$

		\begin{equation*}
			\begin{array}{rcl}
				\frac{5(s+2)}{s(s^2+6s+34)}  & = & \frac{\frac{10}{34}}{s} + \frac{K_2s+K_3}{s^2+6s+34}\\
				5s+10 & = & (\frac{10}{34}+K_2)s^2 + (\frac{30}{17}+K_3)s +10 
			\end{array}
		\end{equation*}
		We then have 2 equations that can give us the answers to the 2 unknowns 

		\begin{equation*}
			\begin{array}{rcl}
				K_2 & = & - \frac{10}{34}\\
				\\
				K_3 & = & - \frac{30}{17}\\
				\\
				G_8(s) & = & \frac{\frac{10}{34}}{s} - \frac{\frac{10}{34}s+\frac{30}{17}}{s^2+6s+34}
			\end{array}
		\end{equation*}

	% section prelab (end)


	\section{Lab} % (fold)
	\label{sec:lab}
		\subsection*{Question 1} % (fold)
		\label{sub:question}
			This question was done by using the \texttt{roots} command. The polynomials were initialized as \par
			\texttt{P\_1 = [0,1,9,26,24];} \par
			\texttt{P\_2 = [1,12,41,30,0];}

			\noindent The resulting polynomials for this questions were obtained by \par
			\texttt{P\_3 = P\_1 + P\_2;} \par
			\texttt{P\_4 = P\_1 - P\_2;} \par
			\texttt{P\_5 = conv(P\_1, P\_2);} \par

			\noindent Running the \texttt{roots} command on the above polynomials, the roots were found to be
			\begin{equation*}
				\begin{array}{rcl}
					s_{P3} & = & \{-6.72,-4.81,-0.733 + j0.452, -0.733 - j0.452\} \\
					s_{P4} & = & \{-5.27 + j0.452,-5.27 - j0.452, -1.19, 0.722\} \\
					s_{P5} & = & \{0,-1,-2,-3,-4,-5,-6\}
				\end{array}
			\end{equation*}
		% subsection question (end)

		\subsection*{Question 2} % (fold)
		\label{sub:question_2}
			\texttt{P\_6 = (tf('s')+7)*(tf('s')+8)*(tf('s')+3)*(tf('s')+5)*(tf('s')+9)*(tf('s')+10);} \par\noindent
			The result of the above command is
			\[
				P_6 = s^6 + 42 s^5 + 718 s^4 + 6372 s^3 + 30817 s^2 + 76530 s + 75600
			\]

		% From the ``symbolic'' package we can use the expand function that expands $G_1(s)$ into a polynomial.\\
		% \texttt{syms s;}\\
		% \texttt{poly = expand((s + 7)*(s + 8)*(s + 3)*(s + 5)*(s + 9)*(s + 10));}\\

		% \noindent Running the above commands gives the following result:\\
		% $s^6 + 42 s^5 + 718 s^4 + 6372 s^3 + 30817s^2+76530s+75600$
		% subsection question_2 (end)

		\subsection*{Question 3} % (fold)
		\label{sub:question_3}
			\texttt{s = tf('s');} \par\noindent
			\texttt{G\_1 = 20*(s+2)*(s+3)*(s+6)*(s+8)/(s*(s+7)*(s+9)*(s+10)*(s+15));}

			\noindent Running the above commands gives the following result:
			\[
				G_1(s) = \frac{20 s^4 + 380 s^3 + 2480 s^2 + 6480 s + 5760}{s^5 + 41 s^4 + 613 s^3 + 3975 s^2 + 9450 s}
			\]

		% subsection question_3 (end)

		\subsection*{Question 4} % (fold)
		\label{sub:question_4}
		\texttt{syms s;}\par\noindent
		\texttt{poly\_num = s**3+9*s**2+26*s+24;}\par\noindent
		\texttt{poly\_den = s**4 +12*s**3+41*s**2+30*s;}\par\noindent
		\texttt{factored\_num = factor(poly\_num);}\par\noindent
		\texttt{factored\_den = factor(poly\_den);}\par\noindent
		? 2 functions only 

		% subsection question_4 (end)

		\subsection*{Question 6} % (fold)
		\label{sub:question_6}
			For this section, the residue command was used to calculate the coefficients of the transfer functions partial fraction expansion. We will show the procedure for calculating the first subquestion, $G_6(s)$.

			\noindent\texttt{num = [0,0,5,10];}\par\noindent
			\texttt{den = [1,8,15,0];}\par\noindent
			\texttt{[r,p,k,e] = residue(num,den);}

			\noindent Where the vector \texttt{r} represents the coefficient in the partial factor expansion. Printing \texttt{r} to screen yields the following results:
			\[
				r_a =
				\begin{bmatrix}
					0.66667 \\
					0.83333 \\
					-1.5
				\end{bmatrix}
			\]
			which corresponds to our previous results of $A=\tfrac{2}{3}$, $C=\tfrac{5}{6}$, $B=\tfrac{-3}{2}$, respectively.

			Doing the same procedure on the other subquestions, we get the following results:
			\[
				r_b =
				\begin{bmatrix}
					-1.1111 \\
					1.6667 \\
					1.1111
				\end{bmatrix}
			\]
			\[
				r_c =
				\begin{bmatrix}
					-0.14706 - j0.41176 \\
					-0.14706 + j0.41176 \\
					0.29412
				\end{bmatrix}
			\]
		% subsection question_6 (end)
	% section lab (end)


	\section{Postlab} % (fold)
	\label{sec:postlab}
		Octave was able to do in a few minutes what would otherwise take a human half an hour to do by hand, and is a very convenient and intuitive way to do scientific computing. An interesting finding in the course of this practical, is that polynomials can be multiplied using convolution.
	% section postlab (end)

	\section{References} % (fold)
	\label{sec:references}
		
	% section references (end)

\end{document}