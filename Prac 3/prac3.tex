\documentclass[a4paper, 12pt]{article}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{float}


\hypersetup{
	colorlinks=true,
	linkcolor=black
}

\begin{document}
	\pagenumbering{gobble}
	\begin{titlepage}
		\centering
		{\LARGE Controls Systems Practical 3 \par}
		\vspace*{1.5cm}
		{\large Q. Kruger, 216008466 \par}
		{\large R. de Bruyn, 216054484 \par}
		\vspace*{1.2cm}
		{\large \today}
		\vspace*{\fill}
		% \includegraphics[width=\textwidth]{img/UJ.jpg}
		\vspace*{\fill}
	\end{titlepage}

	\pagenumbering{roman}
	\tableofcontents
	\newpage
	\pagenumbering{arabic}

	\section{Prelab} % (fold)
	\label{sec:prelab}
		\subsection{Question 1} % (fold)
		\label{sub:prelab_question_1}
			The settling time for a first order transfer function of the form
			\[
				G(s) = \frac{a}{s + a}
			\]
			is given by the formula
			\begin{equation}
				T_s(a) = \frac{4}{a}
				\label{eq:settle}
			\end{equation}
			Using \eqref{eq:settle}, we can easily find the settling time in seconds. Here follows the poles and settling times for various values of $a$
			\[
				T_s(1) = 4\,\text{s}
			\]
			\textit{Insert pole graph here}
			\[
				T_s(2) = 2\,\text{s}
			\]
			\textit{Insert pole graph here}
			\[
				T_s(3) = \frac{4}{3} \approx 1.33\,\text{s}
			\]
			\textit{Insert pole graph here}
		% subsection prelab_question_1 (end)

		\subsection{Question 2} % (fold)
		\label{sub:prelab_question_2}
			For this question, we will investigate how the time response of second order systems changes when the real and imaginary components of the poles are altered. The equation for the components of a pole are given by
			\begin{equation}
				\begin{array}{rcl}
					s & = & -\zeta\omega_n \pm j\omega_n\sqrt{1 - \zeta^2} \\
					& = & -\sigma_d \pm j\omega_d
				\end{array}
				\label{eq:pole_exp}
			\end{equation}
			and the parameters relating to its time response are
			\begin{equation}
				T_s(\sigma_d) = \frac{4}{\sigma_d}
				\label{eq:2nd_ts}
			\end{equation}
			\begin{equation}
				T_p(\omega_d) = \frac{\pi}{\omega_d}
				\label{eq:2nd_tp}
			\end{equation}
			\begin{equation}
				T_r(\omega_n, \zeta) = \tfrac{1}{\omega_n}(1.76\zeta^3 - 0.417\zeta^2 + 1.039 \zeta + 1)
				\label{eq:2nd_tr}
			\end{equation}
			\begin{equation}
				\%OS(\zeta) = \exp\left(-\frac{\zeta\pi}{\sqrt{1 - \zeta^2}}\right) \times 100
				\label{eq:2nd_os}
			\end{equation}

			Since the real and imaginary components are both dependent on $\zeta$ and $\omega_n$, we have to derive a formula to leave the imaginary part of a pole the same after altering the aforementioned parameters, but alter the real part by some factor. Letting this factor be $K$, we can write the system of equations that govern this change as
			\begin{equation}
				\begin{array}{rcl}
					\omega_d' & = & \omega_d \\
					\omega_n'\sqrt{1 - \zeta'^2} & = & \omega_n\sqrt{1 - \zeta^2}
				\end{array}
				\label{eq:der_1}
			\end{equation}
			and
			\begin{equation}
				\begin{array}{rcl}
					\sigma_d' & = & K\sigma_d \\
					\zeta'\omega_n' & = & K \zeta\omega_n
				\end{array}
				\label{eq:der_2}
			\end{equation}

			By substituting $\omega_n' = \frac{K\zeta\omega_n}{\zeta'}$, derived from \eqref{eq:der_2}, into \eqref{eq:der_1}, we get
			\begin{equation}
				\begin{array}{rcl}
					K\zeta\omega_n \frac{\sqrt{1 - \zeta'^2}}{\zeta'} & = & \omega_n\sqrt{1 - \zeta^2} \\
					K\zeta \frac{\sqrt{1 - \zeta'^2}}{\zeta'} & = & \sqrt{1 - \zeta^2} \\
					\frac{\sqrt{1 - \zeta'^2}}{\zeta'} & = & \frac{\sqrt{1 - \zeta^2}}{K\zeta} \\
					\frac{1 - \zeta'^2}{\zeta'^2} & = & \frac{1 - \zeta^2}{K^2\zeta^2} \\
					1 - \zeta'^2 & = & \left(\frac{1 - \zeta^2}{K^2\zeta^2}\right)\zeta'^2 \\
					\left(\frac{1 - \zeta^2}{K^2\zeta^2} + 1\right) \zeta'^2 & = & 1 \\
					\left(\frac{1 + (K^2 - 1) \zeta^2}{K^2\zeta^2}\right) \zeta'^2 & = & 1 \\
					\zeta' & = & \sqrt{\frac{K^2\zeta^2}{1 + (K^2 - 1) \zeta^2}} \\
					\zeta' & = & \frac{K\zeta}{\sqrt{1 + (K^2 - 1) \zeta^2}} \\
				\end{array}
				\label{eq:zeta_dash}
			\end{equation}
			and substituting this expression from \eqref{eq:zeta_dash} into \eqref{eq:der_2}, we get
			\begin{equation}
				\begin{array}{rcl}
					\omega_n' & = & \frac{K \zeta \omega_n}{\zeta'} \\
					& = & K\zeta\omega_n\frac{\sqrt{1 + (K^2 - 1)\zeta^2}}{K\zeta} \\
					& = & \omega_n\sqrt{1 + (K^2 - 1)\zeta^2}
				\end{array}
				\label{eq:omega_dash}
			\end{equation}

			Now, if we consider the equation for a second order transfer function given by
			\[
				G(s) = \frac{\omega_n^2}{s^2 + 2\omega_n\zeta + \omega_n^2} = \frac{25}{s^2 + 4s + 25}
			\]
			we can easily calculate that $\omega_n = 5$ and $\zeta = \frac{2}{5}$, and thus that $\sigma_d = 2$ and $\omega_d = \sqrt{21}$. From this transfer function, then, the time response is
			\[
				\%OS = 25.38\%
			\]

			\[
				T_s = 2 \,\text{s}
			\]

			\[
				T_p = 0.6856\,\text{s}
			\]

			\[
				T_r = 0.2923\,\text{s}
			\]

			Multiplying the real part of the poles of $G(s)$ with a factor of $K=2$, we use formulas \eqref{eq:zeta_dash} and \eqref{eq:omega_dash} to find our new parameters, denoted $\omega_n' = \sqrt{37}$, $\zeta' = \frac{4}{\sqrt{37}}$, $\sigma_d' = 4$, and $\omega_d' = \omega_d = \sqrt{21}$. Our modified time response to multiplying the real part of the pole by 2 is

			\[
				\%OS' = 6.44\%
			\]

			\[
				T_s' = 1\,\text{s}
			\]

			\[
				T_p' = 0.6856\,\text{s}
			\]

			\[
				T_r' = 0.3294\,\text{s}
			\]

			Using the same process as above, multiplying the real part of the poles of $G(s)$ with a factor of $K=\frac{1}{2}$, we get $\omega_n'' = \sqrt{37}$, $\zeta'' = \frac{4}{\sqrt{37}}$, $\sigma_d'' = 4$, and $\omega_d'' = \omega_d = \sqrt{21}$. Our modified time response in this case is

			\[
				\%OS'' = 50.38\%
			\]

			\[
				T_s'' = 4\,\text{s}
			\]

			\[
				T_p'' = 0.6856\,\text{s}
			\]

			\[
				T_r'' = 0.26\,\text{s}
			\]

		% subsection prelab_question_2 (end)
	% section prelab (end)

	\section{Lab} % (fold)
	\label{sec:lab}
		This experiments was done using the Ocatve Control package
	\subsection{Question 1}
	\label{sec:question_1_lab}
		The transfer functions of interest in this Lab question are:
			\begin{equation}
				\begin{array}{rcl}
					g_1 = \frac{1}{s+1}\\
					g_2 = \frac{2}{s+2}\\
					g_3 = \frac{3}{s+3}
				\end{array}
			\end{equation}
		$g_1$, $g_1$ and $g_1$ were captured in an Octave function and the step responses of these systems were obtained by executing the function given as:
		\texttt{g1 = tf([1],[1,1])}
		\texttt{g2 = tf([2],[1,2])}
		\texttt{g3 = tf([3],[1,3])}

		\texttt{step(g1, 'r');}
		\texttt{hold on;}
		\texttt{step(g2, 'g');}
		\texttt{hold on;}
		\texttt{step(g3, 'b');}
		\texttt{hold off;}

		\texttt{legend('g1','g2','g3')}

		The plot obtained for this function is given in Figure \ref{fig:plot_question_1_lab} which shows the step responses of the respective systems:

		\begin{figure}[H]
			\centering
			\includegraphics[width = 150mm]{img/Question_1_Lab_Plots.png}
			\caption{Step reponse plots for the different systems described by respective transfer functions}
			\label{fig:plot_question_1_lab}
		\end{figure}

		\textit{stepinfo function equicvalent in octave to give rise- and settling time}

	\subsection{Question 2}
	\label{question_2_lab}
		The transfer function relevant to the discussion of this Lab experiment is given as:
		\begin{equation}
				G(s) = \frac{b}{s^2+as+b}	
		\end{equation}

		Substituting in values for \texttt{a} and \texttt{b} given as $a = 4$ and $b = 25$ gives the transfer function \texttt{G\_1}:
		\begin{equation}
			G_1(s) = \frac{25}{s^2+4s+25}\\
		\end{equation}

		The poles of this transfer function is given as 
		\begin{equation}
			\begin{array}{rcl}
				s_1 = -4 + \sqrt{21}i\\
				s_2 = -4 - \sqrt{21}i\\
			\end{array}
		\end{equation}

		Finding the values of \texttt{a} and \texttt{b} for changed real components of the poles where the first change is two times the real pole components of the system described by the transfer function \texttt{G\_1}. The values of \texttt{a} and \texttt{b} are given as $a = 8$ and $b = 37$. Thus the new transfer function is given as:

		\begin{equation}
			G_2(s) = \frac{37}{s^2+8s+37}\\
		\end{equation}

		The values of \texttt{a} and \texttt{b} for the real components of the poles of the system described by \texttt{G\_1} halved is $a = 2$ and $b = 22$. The resulting transfer function is given as:
		\begin{equation}
			G_3(s) = \frac{22}{s^2+2s+22}\\
		\end{equation}

		Finding the step response of these transfer functions (\texttt{G\_1, G\_2 and G\_3}) by running the following code in Octave:

		\texttt{g1 = tf([25],[1 4 25]);}
		\texttt{g2 = tf([37],[1 8 37]);
		\texttt{g3 = tf([22],[1 2 22]);}

		\texttt{step(g1, 'r');}
		\texttt{hold on;}
		\texttt{step(g2, 'g');}
		\texttt{hold on;}
		\texttt{step(g3, 'b');}
		\texttt{hold off;}

		\texttt{legend('g1','g2','g3')}



		Gives a plot as shown in Figure \ref{plot_question_2_lab}:

		\begin{figure}[H]
			\includegraphics{img/Question_2_Lab_Plots.png}
			\caption{Step reponse plots for the different systems described by respective transfer functions}
			\label{plot_question_2_lab}
		\end{figure}

		\textit{stepinfo function equicvalent in octave to give rise- and settling time}

	% section lab (end)

	\section{Postlab} % (fold)
	\label{sec:postlab}
		
	% section postlab (end)

\end{document}